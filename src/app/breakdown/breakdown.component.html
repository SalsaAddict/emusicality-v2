<fieldset [disabled]="busy" *ngIf="!!song">
    <div class="card">
        <div class="card-header p-2" style="white-space: nowrap;">
            <div class="media">
                <img [src]="song?.asset('cover.jpg')" class="img-thumbnail mr-3" width="64" height="64">
                <div class="media-body">
                    <div class="d-flex">
                        <div>
                            <h5 class="my-0 font-weight-bold" [innerHTML]="song?.title"></h5>
                            <p class="my-0" [innerHTML]="song?.artist"></p>
                            <small class="my-0 text-muted initialism" [innerHTML]="song?.genre"></small>
                        </div>
                        <div class="ml-auto text-center">
                            <p class="badge badge-primary my-0">
                                <span [innerText]="song?.bpm | number"></span>
                                <span>&nbsp;bpm</span>
                            </p>
                            <h3 class="mt-1 mb-0" [innerText]="beat | number"
                                [ngClass]="{ 'text-danger font-weight-bold': beat === 1 }"></h3>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="card-body p-2 text-center">
            <div class="row">
                <div class="col-6 text-center">
                    <p [ngSwitch]="!!section" class="my-0">
                        <small class="text-muted">Section</small>
                        <br>
                        <b *ngSwitchCase="true" class="text-info" [innerText]="section!.description"></b>
                        <span *ngSwitchCase="false" class="text-muted">&mdash;</span>
                    </p>
                </div>
                <div class="col-6 text-center">
                    <p [ngSwitch]="!!measure?.framework" class="my-0">
                        <small class="text-muted">Framework</small>
                        <br>
                        <b *ngSwitchCase="true" class="text-info" [innerText]="measure!.framework"></b>
                        <span *ngSwitchCase="false" class="text-muted">&mdash;</span>
                    </p>
                </div>
            </div>
            <small class="text-muted my-0">Phrasing</small>
            <div [ngSwitch]="!!section">
                <div *ngSwitchCase="true" class="d-flex flex-row justify-content-center">
                    <div *ngFor="let m of section!.measures; last as isLast">
                        <span [class]="measureClass(m, isLast)"></span>
                    </div>
                </div>
                <span *ngSwitchCase="false" class="text-muted">&mdash;</span>
            </div>
            <div [ngSwitch]="!!measure">
                <div *ngSwitchCase="true" class="d-flex flex-row justify-content-center">
                    <div *ngFor="let tick of measure?.ticks">
                        <i class="text-info fa fa-fw fa-lg" [class]="beat === tick ? 'fa-circle' : 'fa-circle-o'"></i>
                    </div>
                </div>
                <span *ngSwitchCase="false" class="text-muted">&mdash;</span>
            </div>
        </div>
        <div class="card-body p-2">
            <div class="d-flex mb-2" *ngIf="song?.groups?.length">
                <div class="btn-group btn-group-sm mx-auto" role="group">
                    <button type="button" class="btn btn-primary initialism"
                        [ngClass]="{ 'active': song?.activeGroup() }" (click)="song?.filter()">All</button>
                    <button type="button" class="btn btn-primary initialism" *ngFor="let group of song?.groups"
                        [ngClass]="{ 'active': song?.activeGroup(group) }" (click)="song?.filter(group)"
                        [innerText]="group"></button>
                </div>
            </div>
            <div class="list-group mx-auto">
                <div *ngFor="let track of song?.tracks" class="list-group-item d-flex py-2">
                    <div [innerText]="track.description"></div>
                    <div class="btn-group btn-group-sm ml-auto">
                        <button type="button" *ngFor="let volume of ['off', 'down', 'up']" class="btn"
                            [class]="track.isVolume(volume) ? 'btn-primary' : 'btn-outline-primary'"
                            (click)="track.volume(volume, 1)">
                            <i class="fa fa-fw fa-lg" [class]="'fa-volume-' + volume"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <div class="card-footer p-2">
            <div class="d-flex">
                <div class="btn-toolbar mx-auto">
                    <div class="btn-group btn-group-sm mr-5">
                        <button type="button" class="btn btn-primary" (click)="play()" *ngIf="!playing">
                            <i class="fa fa-fw fa-lg fa-play"></i>
                        </button>
                        <button type="button" class="btn btn-primary" (click)="pause()" *ngIf="playing">
                            <i class="fa fa-fw fa-lg fa-pause"></i>
                        </button>
                        <button type="button" class="btn btn-primary" (click)="next()">
                            <i class="fa fa-fw fa-lg fa-forward"></i>
                        </button>
                    </div>
                    <div class="btn-group btn-group-sm">
                        <button type="button" class="btn btn-primary" [ngClass]="{ 'active': isPlaybackRate(rate) }"
                            *ngFor="let rate of playbackRates" (click)="playbackRate(rate)">
                            <span class="initialism" [innerText]="rate"></span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

</fieldset>